{% extends 'app_general/components/base.html' %}
{% block content %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/room.css' %}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<!-- pictures -->
<div class="titlepic">
    <h2>Our Rooms</h2>
</div>

<!-- details -->
<div class="content">
    <div class="details">
        <div class="room">
            <div class="selection">
                <select data-placeholder="All Categories" class="selectpicker" title="All Categories" 
                        data-live-search="true" name="building" 
                        onchange="window.location.href='?building=' + encodeURIComponent(this.value)">
                    <option value="">All Buildings</option>
                    {% for building in buildings %}
                        <option value="{{ building }}" {% if selected_building == building %}selected{% endif %}>
                        {{ building }}
                        </option>
                    {% endfor %}
                </select>
            </div>        
        </div>
        <div class="addspace"></div>

        {% for room in rooms %}
        <div class="room">
            <img src="{{ room.image1.url }}">
            <div class="room-details">
                <h1><a href="{% url 'room_detail' room.id %}">{{ room.name }}</a></h1>
                <p><strong>Building:</strong>  {{ room.building }}</p>
                <p><strong>Capacity:</strong> {{ room.capacity }}</p>
                <p><strong>Status:</strong>  {{ room.status }}</p>
                <div class="icons">
                    {% if room.has_mic %}<i class="bi bi-mic"></i>{% endif %}
                    {% if room.has_camera %}<i class="bi bi-camera"></i>{% endif %}
                    {% if room.has_laptop %}<i class="bi bi-laptop"></i>{% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- filters -->
    <div class="container">
        <div class="box">
            <div class="form">
                <form method="GET" action="" class="search-form"></form>
                <h3>Search for</h3>
                <form method="GET" action="" class="search-form">
                    <div class="name">
                        <div class="input-box">
                            <input type="text" name="search" value="{{ search_query }}" placeholder="Search rooms...">
                        </div>
                    </div>
                    <button type="submit" class="btn">SEARCH</button>
                </form>
            </div>
        </div>

        <div class="categories">
            <h3><a href="?{% if selected_building %}building={{ selected_building }}&{% endif %}{% if search_query %}search={{ search_query }}&{% endif %}category=" class="{% if not selected_category %}active{% endif %}">All Categories</a></h3>
            {% for category_value, category_label in categories %}
            <ul>
                <li><a href="?{% if selected_building %}building={{ selected_building }}&{% endif %}{% if search_query %}search={{ search_query }}&{% endif %}category={{ category_value }}" 
                    class="{% if category_value == selected_category %}active{% endif %}">
                     {{ category_label }}
                 </a></li>
            </ul>
            {% endfor %}
        </div>
    </div>
</div>
</div>
{% endblock %}
