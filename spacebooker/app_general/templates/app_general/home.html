{% extends 'app_general/components/base.html' %}

{% block content %}
{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'css/home.css' %}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<div id="home" class="" data-background-image="">
    <div class="main_inner_search_block">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h2>SpaceBooker</h2>
                <p>
                    Welcome to SpaceBooker, we are the ultimate platform for booking rooms and spaces in the Engineering Faculty.<br>
                    Whether you need a quiet space to study, host a meeting, or organize an event, SpaceBooker simplifies the easy booking process.<br>
                    Open to students, faculty, staff, and visitors, You can find the right space when you need it, free here!</p>
                <a href="{% url 'room' %}" class="book_click">Book Here!</a>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
    <div class="room" id="room_section">
    <h1 style="font-size: 40px;">Our Room Types</h1>
    <p style="text-align: center;">Discover a variety of room options that cater to different needs.<br>
        Whether you're hosting a meeting, collaborating on a project, or needing a quiet study space.<br>
        Each room offers unique features to suit your purpose.</p>
    <div class="line"></div>
    <div class="row">
        <!-- Column 1 -->
        <div class="col-md-4 col-sm-6">
            <div class="card">
                
                <img src="{% static 'img/conference1.jpeg' %}" class="card-img-top" alt="Room 1">
                <div class="describe">
                    <h3 style="text-align: center;"  class ="card-title">Conference</h3>
                    <p class="card-text"></p>
                    
                </div>
            </div>
        </div>
        <!-- Column 2 -->
        <div class="col-md-4 col-sm-6">
            <div class="card">
                <img src="{% static 'img/Rooom2.jpg' %}" class="card-img-top" alt="Room 2">
                <div class="describe">
                    <h3 style="text-align: center;"  class ="card-title">Meeting</h3>
                    <p class="card-text"></p>
                    
                </div>
            </div>
        </div>
        <!-- Column 3 -->
        <div class="col-md-4 col-sm-6">
            <div class="card">
                <img src="{% static 'img/classroom.jpg' %}" class="card-img-top" alt="Room 3">
                <div class="describe">
                    <h3 style="text-align: center;"  class ="card-title">Classroom</h3>
                    <p class="card-text"></p>
                    
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Column 4 -->
        <div class="col-md-4 col-sm-6">
            <div class="card">
                <img src="{% static 'img/lab.jpg' %}"class="card-img-top" alt="Room 1">
                <div class="describe">
                    <h3 style="text-align: center;"  class ="card-title">Laboratory</h3>
                    <p class="card-text"></p>
                   
                </div>
            </div>
        </div>
        <!-- Column 5 -->
        <div class="col-md-4 col-sm-6">
            <div class="card">
                <img src="{% static 'img/workingspace.jpg' %}" class="card-img-top" alt="Room 2">
                <div class="describe">
                    <h3 style="text-align: center;"  class ="card-title">Working Space</h3>
                    <p class="card-text"></p>
                   
                </div>
            </div>
        </div>
        <!-- Column 6 -->
        <div class="col-md-4 col-sm-6">
            <div class="card">
                <img src="{% static 'img/room_example.jpg' %}" class="card-img-top" alt="Room 3">
                <div class="describe">
                    <h3 style="text-align: center;"  class ="card-title">Coming soon...</h3>
                    <p class="card-text"></p>
                   
                </div>
            </div>
        </div>
    </div>
      
    <section id="upcoming_bookings" class="calendar">
        <h1 style="font-size: 40px;" class="text-center mb-4">Upcoming Bookings</h1>
        <p style="text-align: center;">Select your preferred date to view bookings in the upcoming week.
        </p>
        <div class="container">
            <div class="row justify-content-center mb-4">
                <div class="col-md-6">
                    <form method="get" class="d-flex justify-content-center">
                        <input type="date" 
                               class="form-control text-calendar" 
                               id="selected_date" 
                               name="selected_date"
                               value="{{ selected_date|date:'Y-m-d' }}"
                               onchange="this.form.submit()">
                    </form>
                </div>
            </div>
    
            <!-- Bookings Display -->
            {% if bookings_by_date %}
                {% for date, bookings in bookings_by_date.items %}
                    <div class="date-section mb-4" id="date-section">
                        <h3 class="date-header mb-3">{{ date|date:"l, F j, Y" }}</h3>
                        <div class="row">
                            {% for booking in bookings %}
                                <div class="col-md-4 mb-4">
                                    <div class="card h-100 shadow-sm">
                                        {% if booking.room.image1 %}
                                            <img src="{{ booking.room.image1.url }}" 
                                                 class="card-img-top" 
                                                 alt="{{ booking.room.name }}"
                                                 style="height: 200px; object-fit: cover;">
                                        {% endif %}
                                        
                                        <div class="card-body">
                                            <h3 class="card-title">{{ booking.room.name }}</h3>
                                            <div class="booking-details">
                                                <p class="mb-2" style="color: black;">
                                                    <i class="fas fa-building"></i>
                                                    <strong>Building:</strong> 
                                                    {{ booking.room.building }}
                                                </p>
                                                <p class="mb-2" style="color: black;">
                                                    <i class="fas fa-clock"></i>
                                                    <strong>Time:</strong>
                                                    {{ booking.start_time|time:"H:i" }} - {{ booking.end_time|time:"H:i" }}
                                                </p>
                                                <p class="mb-2" style="color: black;">
                                                    <i class="fas fa-info-circle"></i>
                                                    <strong>Purpose:</strong>
                                                    {{ booking.purpose|default:"Not specified" }}
                                                </p>
                                                {% if booking.room.floor %}
                                                <p class="mb-2" style="color: black;">
                                                    <i class="fas fa-level-up-alt"></i>
                                                    <strong>Floor:</strong>
                                                    {{ booking.room.floor }}
                                                </p>
                                                {% endif %}
                                                {% if booking.room.capacity %}
                                                <p class="mb-2" style="color: black;">
                                                    <i class="fas fa-users"></i>
                                                    <strong>Booked by:</strong>
                                                    {{ booking.user.username }}
                                                </p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="col-12 text-center">
                    <div class="alert alert-info">
                        No approved bookings found for the selected date range.
                    </div>
                </div>
            {% endif %}
        </div>
    </section>
   
</div>

</div>
<script>
    $(function() {
    $('input[name="datetimes"]').daterangepicker({
        timePicker: true,
        startDate: moment().startOf('hour'),
        endDate: moment().startOf('hour').add(32, 'hour'),
        locale: {
        format: 'M/DD hh:mm A'
        }
    });
    });
    </script>

    <script>
    // Manage scroll
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetElement = document.getElementById(targetId);
            const scrollPadding = parseInt(this.getAttribute('data-scroll-padding') || '0', 10);
            
            const elementPosition = targetElement.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - scrollPadding;

            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        });
    });
</script>
{% endblock %}